---
title: 进程与线程
date: 2020-11-06 16:25:25
tags: 多线程与并发
categories: 多线程与并发
---

## 0. 进程与线程

**进程**是应用程序在内存中分配的空间，也就是正在运行的程序。各个进程之间互不干扰，进程保存着程序的每个时刻的运行状态。

**线程**是进程的子任务，每个进程可以包含多个线程，每个线程单独负责一个子任务。

### 0.1 进程与线程的区别

1. 进程是一个独立的运行环境，而线程是在进程中执行的一个任务，线程依赖于进程而存在。他们本质的区别是是否单独占有内存地址空间及其它系统资源（比如I/O）：
    - 进程单独占有内存地址空间，所以数据共享复杂但是同步简单，各个进程之间互不干扰；而多个线程共享其所属进程的内存地址空间和资源，数据共享简单，但是同步复杂。
    - 进程单独占有内存地址空间，一个进程出现问题不会影响其他进程，不影响主程序的稳定性，可靠性高；一个线程崩溃可能影响整个程序的稳定性，可靠性较低。
    - 进程是重量级的，而线程是轻量级的。进程的创建和销毁不仅需要保存寄存器和栈信息，还需要资源的分配回收以及页调度，开销较大；线程只需要保存寄存器和栈信息，开销较小。
2. 进程是操作系统进行资源分配的基本单位，而线程是操作系统进行调度的基本单位，即CPU分配时间的单位。

### 0.2 上下文切换

上下文指某一时间点的 CPU 寄存器和程序计数器的内容。

上下文切换是指 CPU 从一个进程（线程）切换到另一个进行（线程）。

CPU 为某个线程分配 CPU 时间片来实现多线程机制，CPU 通过时间片分配算法来循环执行任务，当前任务执行一个时间片后会切换到下一个任务。
- 在任务切换前会保存上一个任务的运行状态，该任务从保存到加载的过程就是一次上下文切换。












